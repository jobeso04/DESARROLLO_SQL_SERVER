  declare @lcfecha1 datetime = convert(datetime, '2017-09-01', 101)
  declare @lcfecha2 datetime = convert(datetime, '2017-09-30', 101)
  
    SELECT PACIENTE, case when SEXO = 'F' then '1' ELSE '2' END AS SEXO,  (CASE WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) < 1 THEN '1' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 1 AND 4 THEN '2' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 5 AND 9 THEN '3'
   WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 10 AND 14 THEN '4' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 15 AND 19 THEN '5'  WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 20 AND 24 THEN '6' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 25 AND 29 THEN '7'
       WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 30 AND 34 THEN '8' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 35 AND 39 THEN '9'  WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 40 AND 44 THEN '10'
       WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 45 AND 49 THEN '11'   WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 50 AND 54 THEN '12'
        WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 55 AND 59 THEN '13'  WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 60 AND 64 THEN '14' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) >=65  THEN '15' END) AS GRUPO_EDAD, 
        UPPER(CIEX4) AS CIEX
   FROM [SIGSALUD].[dbo].[EMERGENCIA]  WHERE FECHA BETWEEN @lcfecha1  AND @lcfecha2 AND ESTADO in ('3', '4', '5')
         AND CIEX4 IN (SELECT CIEX FROM [SIGSALUD].[dbo].[MORBICIEX])
   


  
    SELECT PACIENTE, case when SEXO = 'F' then '1' ELSE '2' END AS SEXO,  (CASE WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) < 1 THEN '1' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 1 AND 4 THEN '2' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 5 AND 9 THEN '3'
   WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 10 AND 14 THEN '4' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 15 AND 19 THEN '5'  WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 20 AND 24 THEN '6' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 25 AND 29 THEN '7'
       WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 30 AND 34 THEN '8' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 35 AND 39 THEN '9'  WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 40 AND 44 THEN '10'
       WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 45 AND 49 THEN '11'   WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 50 AND 54 THEN '12'
        WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 55 AND 59 THEN '13'  WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) BETWEEN 60 AND 64 THEN '14' WHEN convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) >=65  THEN '15' END) AS GRUPO_EDAD, 
        UPPER(CIEX4) AS CIEX
   FROM [SIGSALUD].[dbo].[EMERGENCIA]  WHERE FECHA BETWEEN @lcfecha1  AND @lcfecha2 AND ESTADO in ('3', '4', '5')
         AND CIEX4 IN (SELECT CIEX FROM [SIGSALUD].[dbo].[MORBICIEX])


   
   
     ORDER BY GRUPO_EDAD ASC
  
SELECT CIEX FROM   dbo.MORBICIEX
  
  , UPPER(CIEX5) AS CIEX5,  UPPER(CIEX6) AS CIEX6
  
  A02.9
A04
A04.9
A05.9
A08.0
A09
A41.9
B00.9
B01.9
B02.9
B08.5
B19.9
B34.9
B36.9
B82.9
C26.0
D17.2
D18.0
D25.9
D48.7
D75.1
E05.9
E11
E11.9
E13.8
E14.9
E16.2
E86
E87.8
F10.0
F41.0
F41.1
F41.2
F41.9
F43.0
G21
G40.9
G43.0
G43.9
G44.2
G50.0
G51.0
G53.0
G81.9
G83.2
G93.4
H01.0
H10.3
H10.9
H11.3
H40
H57.1
H60.8
H60.9
H61
H65
H65.1
H65.9
H66.9
H81.3
H81.9
H92.0
H93.1
I05.8
I10
I20.9
I21.9
I46.9
I47
I47.9
I48
I49.9
I50.0
I64
I83.9
I84.2
I84.5
I84.9
I88.9
I95.9
J00
J01.9
J02
J02.9
J03.9
J04.0
J04.1
J04.2
J05.0
J06.0
J06.8
J06.9
J11
J15.9
J18
J18.9
J20
J20.1
J20.4
J20.9
J30.4
J31.2
J35.0
J40
J41
J41.1
J42
J45
J45.9
J46
J47
J84
J84.8
J84.9
J96.0
J96.1
K05.0
K08.8
K12.1
K20
K29.0
K29.1
K29.2
K29.5
K29.7
K30
K31.9
K35.0
K35.9
K40.9
K42.0
K56.0
K57
K58.9
K59.0
K61.0
K70.3
K72.9
K73.9
K74.6
K76.9
K80.0
K80.2
K81
K81.0
K81.1
K81.9
K82.0
K85
K92.0
K92.2
L01
L02.0
L02.9
L03.0
L03.1
L03.2
L03.9
L04.9
L20.8
L23.9
L28.0
L28.2
L29.9
L50.0
L50.9
L55.9
L70.0
M06.4
M13.9
M17
M17.9
M19.9
M24.4
M25.4
M25.5
M43.6
M53.3
M54.4
M54.5
M54.9
M60.0
M62.4
M62.6
M62.9
M65.9
M75.3
M75.5
M77.9
M79.0
M79.1
M79.2
M79.6
M94.0
M94.8
N02.9
N04
N18
N18.0
N18.9
N20.0
N20.9
N23
N30
N30.0
N34.3
N39.0
N39.9
N41.1
N42.8
N48.1
N48.8
N48.9
N61
N64.4
N72
N73.6
N73.9
N76.0
N81.4
N83.0
N93.8
N93.9
N94.4
N94.6
O02.1
O03.4
O03.9
O05.9
O13
O20.0
O21.9
O23.0
O23.4
O23.5
O30.0
O32.1
O33.1
O34.2
O40
O41.0
O42.9
O46.8
O47.0
O47.1
O47.9
O48
O68.0
O70.9
O90.2
O90.4
O98.3
O98.9
O99.0
O99.2
O99.3
O99.5
O99.6
O99.8
P01.8
P12.0
P28.8
P78.8
P78.9
P81.9
P83.9
P92.0
R04.0
R04.2
R05
R06.0
R06.6
R07.2
R07.4
R10
R10.0
R10.1
R10.2
R10.3
R10.4
R11
R13
R14
R30
R30.0
R30.9
R33
R41.0
R42
R50
R50.9
R51
R52.9
R55
R56.0
R56.8
R57.9
R59
R60
R82.0
S00.3
S00.5
S00.8
S00.9
S01.0
S01.1
S01.2
S01.3
S01.4
S01.5
S01.7
S01.8
S01.9
S02.2
S02.9
S09.9
S13.4
S14.1
S20.2
S21.2
S21.9
S30.0
S30.2
S31.1
S31.2
S31.5
S40.0
S41.8
S42.0
S42.3
S42.4
S42.9
S43.0
S43.4
S50.0
S51.0
S51.8
S51.9
S52.0
S52.3
S52.4
S52.5
S52.6
S52.9
S53
S53.1
S53.4
S54.0
S60.0
S60.2
S60.9
S61.0
S61.1
S61.7
S61.8
S61.9
S62
S62.3
S62.4
S62.6
S62.8
S63.1
S63.5
S63.6
S69.9
S70.0
S71.1
S72.0
S72.1
S72.3
S73
S79.9
S80.0
S80.1
S80.9
S81.0
S81.9
S82.0
S82.2
S82.3
S82.5
S82.6
S82.8
S83.4
S83.6
S89.9
S90.0
S90.2
S90.3
S90.9
S91.1
S91.3
S92.0
S92.3
S92.5
S93.0
S93.1
S93.4
S93.5
S93.6
S99.9
T00
T00.1
T00.8
T00.9
T14.0
T15.9
T16
T17.2
T18.1
T20.2
T21.1
T21.2
T22.0
T23.2
T24.0
T24.2
T24.3
T26.0
T26.2
T42.4
T46.6
T52.0
T54.3
T60.0
T63.2
T65.9
T78.4



  
  SELECT PACIENTE, case when SEXO = 'F' then '1' ELSE '2' END AS SEXO, convert(int, REPLACE(SUBSTRING(EDAD,1,4),'a','')) AS EDAD, UPPER(CIEX4) AS CIEX4, UPPER(CIEX5) AS CIEX5,  UPPER(CIEX6) AS CIEX6, CIEX1, CIEX2, CIEX3
   FROM [SIGSALUD].[dbo].[EMERGENCIA]  WHERE FECHA BETWEEN @lcfecha1  AND @lcfecha2 AND ESTADO in ('3', '4', '5')
  ORDER BY FECHA DESC 
  
  
  

  DECLARE @lcedad_obtenida VARCHAR(3) = 5
   
  SELECT (CASE WHEN @lcedad_obtenida < 1 THEN '1' WHEN @lcedad_obtenida BETWEEN 1 AND 4 THEN '2' WHEN @lcedad_obtenida BETWEEN 5 AND 9 THEN '3'
   WHEN @lcedad_obtenida BETWEEN 10 AND 14 THEN '4' WHEN @lcedad_obtenida BETWEEN 15 AND 19 THEN '5' 
      WHEN @lcedad_obtenida BETWEEN 20 AND 24 THEN '6' WHEN @lcedad_obtenida BETWEEN 25 AND 29 THEN '7'
       WHEN @lcedad_obtenida BETWEEN 30 AND 34 THEN '8' WHEN @lcedad_obtenida BETWEEN 35 AND 39 THEN '9'
        WHEN @lcedad_obtenida BETWEEN 40 AND 44 THEN '10'
       WHEN @lcedad_obtenida BETWEEN 45 AND 49 THEN '11' 
       WHEN @lcedad_obtenida BETWEEN 50 AND 54 THEN '12'
        WHEN @lcedad_obtenida BETWEEN 55 AND 59 THEN '13'
         WHEN @lcedad_obtenida BETWEEN 60 AND 64 THEN '14' WHEN @lcedad_obtenida >=65  THEN '15' END) AS GRUPO_EDAD
         


  DECLARE @lcedad_obtenida VARCHAR(3) = 5
   
  SELECT (CASE WHEN @lcedad_obtenida < 1 THEN '1' WHEN @lcedad_obtenida BETWEEN 1 AND 4 THEN '2' WHEN @lcedad_obtenida BETWEEN 5 AND 9 THEN '3'
   WHEN @lcedad_obtenida BETWEEN 10 AND 14 THEN '4' WHEN @lcedad_obtenida BETWEEN 15 AND 19 THEN '5' 
      WHEN @lcedad_obtenida BETWEEN 20 AND 24 THEN '6' WHEN @lcedad_obtenida BETWEEN 25 AND 29 THEN '7'
       WHEN @lcedad_obtenida BETWEEN 30 AND 34 THEN '8' WHEN @lcedad_obtenida BETWEEN 35 AND 39 THEN '9'
        WHEN @lcedad_obtenida BETWEEN 40 AND 44 THEN '10'
       WHEN @lcedad_obtenida BETWEEN 45 AND 49 THEN '11' 
       WHEN @lcedad_obtenida BETWEEN 50 AND 54 THEN '12'
        WHEN @lcedad_obtenida BETWEEN 55 AND 59 THEN '13'
         WHEN @lcedad_obtenida BETWEEN 60 AND 64 THEN '14' WHEN @lcedad_obtenida >=65  THEN '15' END) AS GRUPO_EDAD


          
  
  
  
  TRUNCATE TABLE [SIGSALUD].[dbo].[TMP_MOR_ATN_C2]
  TRUNCATE TABLE [SIGSALUD].[dbo].[TMP_MOR_ATN_F_C2]
  TRUNCATE TABLE [SIGSALUD].[dbo].[TMP_MOR_ATN_M_C2]
  