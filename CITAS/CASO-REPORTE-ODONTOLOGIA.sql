USE SIGSALUD

select CONVERT(varchar(10), fecha, 103) as FECHA, HISTORIA, NOMBRES, EDAD, SEXO, B.NOMBRE AS NOMBRE_MEDICO, C.DX, C.DX_DES from ATENCIONC A 
LEFT JOIN MEDICO B ON A.MEDICO = B.MEDICO LEFT JOIN ATENCIOND C ON A.ID_CITA = C.ID_CITA
where A.CONSULTORIO in ('5050', '5010', '5011', '5012')
and A.FECHA between convert(datetime, '01/01/2017', 103) and convert(datetime, '31/01/2017', 103) ORDER BY A.FECHA ASC



select 'AGOSTO' AS  MES, C.DX, C.DX_DES,  COUNT(C.DX) AS CANTIDAD from ATENCIONC A 
LEFT JOIN MEDICO B ON A.MEDICO = B.MEDICO LEFT JOIN ATENCIOND C ON A.ID_CITA = C.ID_CITA
where A.CONSULTORIO in ('5050', '5010', '5011', '5012')
and A.FECHA between convert(datetime, '2017-08-01', 101) and convert(datetime, '2017-08-31', 101) AND C.DX <> '' GROUP BY C.DX, C.DX_DES
ORDER BY C.DX



