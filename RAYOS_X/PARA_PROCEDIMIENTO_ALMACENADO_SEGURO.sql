/* PROCEDIMIENTO PARA SUMAR PLACAS DIGITALES CON SEGURO */

declare @seguro CHAR(2) = '01'
declare @inicio VARCHAR(10) = '20150820'
declare @fin VARCHAR(10) = '20150820'

	SET LANGUAGE SPANISH 

	SELECT 'TOTAL' AS PELICULAS, 
	ISNULL(SUM(DB8_10+DB14_17+DB14_14+DB10_12+DB11_14+DB24_30+DM8_10+DM14_17+DM14_14+DM10_12 + DM11_14 + DM24_30),0) AS TOTAL,
	ISNULL(SUM(DB8_10+DM8_10),0) AS D8_10,ISNULL(SUM(DB14_17+DM14_17),0) AS D14_17,ISNULL(SUM(DB14_14+DM14_14),0) AS D14_14,
	ISNULL(SUM(DB10_12+DM10_12),0) AS D10_12,ISNULL(SUM(DB11_14+DM11_14),0) AS D11_14, ISNULL(SUM(DB24_30+DM24_30),0) AS D24_30 FROM RAYOSX WHERE SEGURO=@seguro AND FECHA BETWEEN @inicio AND @fin
	
	UNION ALL 

	SELECT 'PELICULAS CONFORMES' AS PELICULAS, 
	ISNULL(SUM(DB8_10+DB14_17+DB14_14+DB10_12+DB11_14+DB24_30),0) AS TOTAL,
	ISNULL(SUM(DB8_10),0) AS D8_10, ISNULL(SUM(DB14_17),0) AS D14_17,ISNULL(SUM(DB14_14),0) AS D14_14,ISNULL(SUM(DB10_12),0) AS D10_12,
	ISNULL(SUM(DB11_14),0) AS D11_14, ISNULL(SUM(DB24_30),0) AS D24_30 FROM RAYOSX WHERE SEGURO=@seguro AND FECHA BETWEEN @inicio AND @fin
	
	UNION ALL 
	
	SELECT 'PELICULAS FALLADAS' AS PELICULAS, 
	ISNULL(SUM(DM8_10+DM14_17+DM14_14+DM10_12+DM11_14+DM24_30),0) AS TOTAL,
	ISNULL(SUM(DM8_10),0) AS D8_10,ISNULL(SUM(DM14_17),0) AS D14_17,ISNULL(SUM(DM14_14),0) AS D14_14,ISNULL(SUM(DM10_12),0) AS D10_12,
	ISNULL(SUM(DM11_14),0) AS D11_14, ISNULL(SUM(DM24_30),0) AS D24_30  FROM RAYOSX
	WHERE SEGURO=@seguro AND FECHA BETWEEN @inicio AND @fin