USE SIGSALUD
declare @lcfecha1 datetime = convert(datetime, '2017-02-01', 101)
declare @lcfecha2 datetime = convert(datetime, '2017-02-28', 101)

TRUNCATE TABLE [SIGSALUD].[dbo].[TMP_CIEMERHOS]
INSERT INTO [SIGSALUD].[dbo].[TMP_CIEMERHOS]([CIEX],[CANTIDAD])

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A00.9', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A00.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A00.9', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A09.0', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A09.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A09.0', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A04.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A04.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A04.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A09.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A09.9', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A09.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A00', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A00', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A00', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A01.0', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A01.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A01.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A01.1', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A01.1', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A01.1', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A01.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A01.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A01.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A01.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A01.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A01.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A01.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A01.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A01.4', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A02.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 

UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A02.0', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A02.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A03.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A03.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A03.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A03.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A03.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A03.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A04.5', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A04.5', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A04.5', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A05', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A05', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A05', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A06.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A06.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A06.0', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A06.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A06.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A06.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A07', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A07', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A07', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A08.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A08.0', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A08.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A08.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A08.2', 'E86', 'R57.1', 'K56.0', 'E87.2')  AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A08.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3



union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A08.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A08.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A08.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3


union all 

SELECT CIEX1 AS CIEX, COUNT(CIEX1) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX1 IN ('A08.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX1 = 'D' GROUP BY CIEX1 
UNION ALL 
SELECT CIEX2 AS CIEX, COUNT(CIEX2) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX2 IN ('A08.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX2 = 'D' GROUP BY CIEX2
UNION ALL
SELECT CIEX3 AS CIEX, COUNT(CIEX3) AS CANTIDAD FROM EMERGENCIA WHERE FECHA BETWEEN @lcfecha1 AND @lcfecha2 AND substring(EDAD,1,3) < '005' and
CIEX3 IN ('A08.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TIPO_CIEX3 = 'D' GROUP BY CIEX3

UNION ALL

SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 IN ('A00.9', 'E86', 'R57.1', 'K56.0', 'E87.2') and TipoEdad = '1' AND Edad < 5 group by DX1 

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A09.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A04.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A09.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  
UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A00', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  
UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A01.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in('A01.1', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
 

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A01.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 


UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A01.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 


UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A01.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 


UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A02.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 


UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A03.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 


UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A03.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 



UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A04.5', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A05', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  


UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A06.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  
  
UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A07', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A08.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A08.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  

UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A08.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  
  
UNION ALL
SELECT DX1 as CIEX, COUNT(DX1) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A08.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX1 
  
 
 UNION ALL

SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 IN ('A00.9', 'E86', 'R57.1', 'K56.0', 'E87.2') and TipoEdad = '1' AND Edad < 5 group by DX2 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX1 in ('A09.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A04.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A09.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  
UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A00', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A01.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in('A01.1', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A01.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 


UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A01.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 


UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A01.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 


UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A02.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 


UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A03.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 


UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A03.9', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 



UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A04.5', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A05', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  


UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A06.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  
  
UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A07', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A08.0', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A08.2', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  

UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A08.3', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 
  
  
UNION ALL
SELECT DX2 as CIEX, COUNT(DX2) as CANTIDAD FROM HOSPITALIZACION 
  WHERE FECHA1 BETWEEN @lcfecha1 AND @lcfecha2 and DX2 in ('A08.4', 'E86', 'R57.1', 'K56.0', 'E87.2') AND TipoEdad = '1' AND Edad < 5 group by DX2 

SELECT CIEX, SUM(CANTIDAD) AS CANTIDAD FROM [SIGSALUD].[dbo].[TMP_CIEMERHOS] GROUP BY CIEX 
 
 